/*!CK:2635155676!*//*1392732468,178179357*/

if (self.CavalryLogger) { CavalryLogger.start_js(["OnOlq"]); }

__d("HomeAdFirstRightColumnController",["Arbiter","CSS","DOM","Event","Run","Style","TickerController","UIIntentionalStreamMessage","Vector","$","copyProperties","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){}q(s.prototype,{init:function(t){q(this,{_enableSidebar:t.enableSidebar,_tickerHeightOffset:200,contentCol:p('contentCol'),blueBar:p('blueBar'),_tickerMaxHeight:(t.tickerMaxHeight||500),_listeners:[],_subscriptions:[]});this._topOffset=0;this.PADDING_TICKER_TO_TOP=0;this.PADDING_RHC_TO_BOTTOM=60;this.MIN_TICKER_HEIGHT=50;this._sidebarIsHidden=true;this._listeners.push(j.listen(window,'resize',this.handleResize.bind(this)));this._blueBarHeight=o.getElementDimensions(this.blueBar).y;this.reloadRightCol();this._initSubscriptions();k.onUnload(this.cleanup.bind(this));this._listeners.push(j.listen(window,'scroll',this._handleScroll.bind(this)));if(!h.hasClass(document.documentElement,'sidebarMode')){this._onSidebarHide();}else if(this._enableSidebar)this._onSidebarShow();this.handleResize();},_initSubscriptions:function(){this._subscriptions=[g.subscribe('Ticker/storiesInserted',this.handleResize.bind(this)),g.subscribe(n.INSERT_STORIES,this.handleResize.bind(this))];if(this._enableSidebar){this._subscriptions.push(g.subscribe('sidebar/hide',this._onSidebarHide.bind(this)));this._subscriptions.push(g.subscribe('sidebar/show',this._onSidebarShow.bind(this)));}},_onNavHandler:function(t,u){var v=u.params.key;if(v!='lf'&&v!='h')this.cleanup();},reloadRightCol:function(){this.fixedScrollingContainer=r('fixed_scrolling_container');this.fixedScrollingWrapper=i.scry(this.fixedScrollingContainer,'.fixed_scrolling_wrapper')[0];this.tickerPagelet=r('pagelet_rhc_ticker');if(!this.tickerPagelet)return false;this.tickerContainer=i.scry(this.tickerPagelet,'.ticker_container')[0];this.tickerStream=i.scry(this.tickerPagelet,'.ticker_stream')[0];return this.tickerContainer&&this.tickerStream;},cleanup:function(){this._subscriptions.forEach(g.unsubscribe);this._subscriptions=[];this._listeners.forEach(function(t){t.remove();});this._listeners=[];},_handleScroll:function(){if(!this._sidebarIsHidden||!this.tickerStream||!this.fixedScrollingContainer)return;this._topOffset=this.PADDING_TICKER_TO_TOP+this._blueBarHeight;var t=h.hasClass(document.documentElement,'tinyViewport'),u=!t;if(u){var v=o.getElementPosition(this.fixedScrollingContainer,'viewport');if(!v||v.y>=this._topOffset)u=false;}if(u!==h.hasClass(this.fixedScrollingWrapper,'fixed_elem'))this._setFixedRightCol(u);},_setFixedRightCol:function(t){var u=t?this._topOffset+'px':'';l.set(this.fixedScrollingWrapper,'top',u);h.conditionClass(this.fixedScrollingWrapper,'fixed_elem',t);var v=t?'Ticker/fixed':'Ticker/unfixed';g.inform(v);},handleResize:function(){if(!this._sidebarIsHidden||!this.tickerStream||h.hasClass(document.documentElement,'tinyViewport'))return;this._handleScroll();var t=o.getViewportDimensions().y,u=o.getElementDimensions(this.fixedScrollingWrapper).y-o.getElementDimensions(this.tickerContainer).y,v=t-this._topOffset-u-this.PADDING_RHC_TO_BOTTOM,w=o.getElementDimensions(this.tickerStream).y,x=Math.min(v,w,this._tickerMaxHeight);x=Math.max(this.MIN_TICKER_HEIGHT,x);l.set(this.tickerContainer,'height',x+'px');},_onSidebarHide:function(){this._sidebarIsHidden=true;this.reloadRightCol();var t=function(){if(this.reloadRightCol())this.handleResize();};this.tickerPagelet&&m.show(this.tickerPagelet,t.bind(this));},_onSidebarShow:function(){this._sidebarIsHidden=false;this.reloadRightCol();this._setFixedRightCol(false);this.tickerPagelet&&m.hide(this.tickerPagelet);}});e.exports=s;});
__d("legacy:HomeAdFirstRightColumnController",["HomeAdFirstRightColumnController"],function(a,b,c,d){a.HomeAdFirstRightColumnController=b('HomeAdFirstRightColumnController');},3);